<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8">
<title>MATLAB Machine Learning Tutorial</title>
<meta name="description" content="MATLAB Machine Learning Tutorial - RoboCup Rescue Simulation League">
<meta name="author" content="Luis Gustavo Nardin">
<meta name="author" content="Arnoud Visser">
<meta name="author" content="Sebastian Castro">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
/>

<link rel="stylesheet"
  href="reveal/css/reveal.min.css"
/>
<link rel="stylesheet"
  href="reveal/css/theme/simple.css"
  id="theme"
/>
<link rel="stylesheet"
  href="reveal/lib/css/zenburn.css"
/>
<script>
  document.write( '<link rel="stylesheet" href="reveal/css/print/' +
      (window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper') +
      '.css" type="text/css" media="print">' );
</script>

</head>
<body>

  <div class="reveal">
    <div class="slides">
	
		<!-- Title Slide -->
		<section>
			<h3>MATLAB Machine Learning Tutorial</h3>
			<h4>RoboCup Rescue Simulation League</h4>
			<h5>Arnoud Visser, Luis G. Nardin, and Sebastian Castro</h5>
		</section>

		<!-- TOC -->
      <section>
        <section>
          <h2>Table of Contents</h2>
          <ol>
            <li>Introduction to AI and Machine Learning (ML)              <ul>
				<li>Artificial intelligence</li>
                <li>Machine learning</li>
				<li>Deep learning</li>
              </ul>
            </li>
            <li>AI and Machine Learning Techniques in RCRS</li>
            <li>AI for Precomputation
              <ul>
                <li>Path Planning (A*, Dijkstra)
                  <ul>
                    <li>Graph creation and visualization in MATLAB</li>
                    <li>Integrate into ADF</li>
                  </ul>
                </li>
                <!--li>Convex Hull</li-->
              </ul>
            </li>
          </ol>
        </section>
        <section>
          <h2>Table of Contents</h2>
          <ol start="5">
            <li>Machine Learning for Precomputation
              <ul>
                <li>Clustering (K-Means++)
                  <ul>
                    <li>Type and collection of data</li>
                    <li>Visualize using MATLAB</li>
                    <li>Integrate into ADF</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>Methodology for Target Selection
              <ul>
                <li>Target selection model
                  <ul>
                    <li>Traditional Machine Learning (SVM)</li>
                    <li>Deep Learning</li>
                  </ul>
                </li>
                <li>Collect data</li>
                <li>Train model in MATLAB</li>
                <li>Integrate into ADF</li>
                <li>Refine the target selection model</li>
              </ul>
            </li>
          </ol>
        </section>
      </section>
	  
	  <!-- Introduction to AI and ML Section -->
      <section>
        <section>
			<h2>Introduction to AI and Machine Learning (ML)</h2>
        </section>
		<section>
			<h3>Introduction to AI</h3>
			<p>
			<ul>
				<li>The question is: 'What is Artificial Intelligence'?
				<div align=center>
				<img src=images/simple-robot.png width=400>
				</div>
			</ul>
		</section>
		<section>
			<h3>Introduction to AI</h3>
			<p>
			<ul>
				<li>The answer of Russell and Norvig: 'A problem-solving agent'!
				<div align=center>
				<img src=images/amai-robot.jpg width=600>
				</div>
			</ul>
			<p>
			<small>Illustration courtesy Stuart Russell and Peter Norvig, <i>Artificial Intelligence - a Modern Approach</i>, Pearson.</small>
		</section>
		<section>
		    <h3>Types of AI Problems</h3>
			<ul>
				<li>Basically... everything robots do!</li>
			</ul>
			<div align=center>
			<img src=images/wikipedia_ai_problems.png>
			</div>
			<small>Source: <a href="https://en.wikipedia.org/wiki/Artificial_intelligence">Wikipedia</a></small>
		</section>
		<section>
		    <h3>Terminology</h3>
			<div align=center>
			<img src=images/ai_ml_dl.jpg>
			</div>
			<small>Source: <a href="https://medium.com/intro-to-artificial-intelligence/deep-learning-series-1-intro-to-deep-learning-abb1780ee20">Deep Learning Series 1: Intro to Deep Learning, Medium, Dhanoop Karunakaran</a></small>
		</section>
		<section>
			<h3>Types of AI Algorithms</h3>
			<div align=center>
			<img src=images/wikipedia_ai_tools.png>
			</div>
			<small>Source: <a href="https://en.wikipedia.org/wiki/Artificial_intelligence">Wikipedia</a></small>
		</section>
		<section>
		    <h3>Machine Learning</h3>
			<ul>
				<li>Subset of AI</li>
				<li>Machine modifies its own algorithm/model/policy/etc. using data</li>
				<li>Human controls the "rules" of how this "learning" occurs, e.g.
					<ul>
						<li>Choosing a model and its initial state</li>
						<li>Choosing a learning algorithm</li>
						<li>Supplying data</li>
						<li>Enforcing constraints</li>
					</ul>
				</li>
				<li>Machine applies learning results autonomously on new data/environments/conditions/etc.</li>
			</ul>
		</section>
		<section>
			<h3>Types of ML Problems (and Examples)</h3>
			<ul>
				<li><b>Classification:</b>
					<ul>
						<li><i>Binary:</i> Detecting occupancy in a room</li>
						<li><i>Multi-class:</i> Detecting the type of animal in an image</li>
					</ul>
				</li>
				<li><b>Regression:</b> Predicting housing costs</li>
				<li><b>Object detection:</b> Locating all pedestrians in an image</li>
				<li><b>Generation:</b> Computer-generated music from input genre</li>
			</ul>
		</section>
		<section>
		    <h3>Types of ML: Unsupervised Learning</h3>
			<ul>
				<li>Finding patterns from <b>unlabeled</b> data</li>
				<li>Machine develops its own insights and we have to make sense of them</li>
			</ul>
			<div align=center>
			<img src=images/clustering_example.png>
			</div>
			<small>Source: MathWorks Documentation</small>
		</section>
		<section>
		    <h3>Types of ML: Supervised Learning</h3>
			<ul>
				<li>Determining a model from <b>labeled</b> data</li>
				<li>Goal: Identify labels accurately on new, independent data
			</ul>			
			<div align=center>
			<img src=images/supervised_example.png>
			</div>
			<small>Source: MathWorks Documentation</small>
		</section>
		<section>
			<h3>Types of ML: Supervised Learning</h3>
			<ul>
				<li><b>Perceptron:</b> The first supervised learning approach</li>
				<li>Use optimization to parameterize a linear classifier</li>
				<li>Other supervised learning approaches extend this with more complex models and learning techniques</li>
			</ul>
			<div align=center>
			<img src=images/perceptron.gif width=700>
			</div>
			<small>Source: <a href="https://devashishshankar.wordpress.com/2015/11/13/demystifying-deep-neural-networks/">Demystifying deep neural networks, by Devashish Shankar</a></small>
		</section>
		<section>
		    <h3>Types of ML: Reinforcement Learning</h3>
			<ul>
				<li>Technically, a type of supervised learning</li>
				<li>Human provides a mathematical cost/reward function</li>
				<li>Machine repeatedly acts in simulation or real-world trials, evaluates reward, and "learns" to maximize reward over time</li>
				<div align=center>
				<img src=images/deepmind.gif>
				</div>
				<small>Source: Google DeepMind</small>
			</ul>
		</section>
		<section>
		    <h3>Deep Learning</h3>
			<ul>
				<li>Not a type of machine learning -- can be unsupervised, supervised, or reinforcement</li>
				<li>Example: "Deep reinforcement learning"
				<li>"Deep" refers to neural networks with many layers</li>
				<li>More layers = more nonlinear = better explains complex systems</li>
				<div align=center>
				<img src=images/neural_net_example.png width=600>
				</div>				
				<small>Source <a href="https://towardsdatascience.com/applied-deep-learning-part-1-artificial-neural-networks-d7834f67a4f6">Applied Deep Learning - Part 1: Artificial Neural Networks, Towards Data Science, by Arden Dertat</a></small>
			</ul>
		</section>
	</section>

	  <!-- AI and ML in RCRS -->
      <section>
        <section>
            <h2>AI and Machine Learning Techniques in the RoboCup Rescue Simulation League</h2>
        </section>
        <section>
            <h2>AI tasks</h2>

            <ul>
            <li>Task allocation with uncertainty
            <li>Coalition formation
            <li>Co-operation
            <li>Distributed versus centralized control
            <li>Communication
            </ul>

 <small>Courtesy Kitano <i>et al</i>, IEEE SMC'99.</small>
        </section>
        <section>
            <h2>Task allocation with uncertainty</h2>

            <ul>
            <li>The assignment problem can be formulated as follows:
            <ul>
            <li>A set <i>J</i> of tasks to be allocated to a set <i>I</i> of agents
            <li>Communication
            </ul>
            </ul>

 <small>Courtesy Ferreira <i>et al</i>, AAMAS'10.</small>
        </section>
      <!-- ========================= TBC  ========================== -->
      </section>
      <section>
        <section>
            <h2>AI for Precomputation</h2>
              <ul>
                <li>Path Planning (A*, Dijkstra, depth-first)
                  <!--ul>
                    <li>Graph creation and visualization in MATLAB</li>
                    <li>Integrate into ADF</li>
                  </ul-->
                </li>
                <!--li>Convex Hull</li-->
              </ul>
            </li>
          </ol>
        </section>
        <!--#include file="pathplanning-slides.html" --> <!-- doesn't work!-->


<section>
<h3>Path-Planning and Artificial Intelligence</h3>

<p>

<ul>
<li>A problem-solving agent applies a <i>search strategy</i> on the problem:

<div align=center>
<img src=images/simple-problem-solving-agent.png width=800>
</div>

<li>So, we need a problem formulation <small>(both in Java and MATLAB)</small>.
</ul>

<p>

 <small>Illustration courtesy Stuart Russell and Peter Norvig, <i>Artificial Intelligence - a Modern Approach</i>, Pearson.</small>
</section>
<section>
<h3>Path-Planning as Graph Search</h3>

<p>

<ul>
<li>Imagine an agent that travels in Romania:

<div align=center>
<img src=images/Romania.jpg width=600>
</div>

<li>The goal is to get in Bucharest (from Arad).
</ul>

<p>

 <small>Illustration courtesy Stuart Russell and Peter Norvig, <i>Artificial Intelligence - a Modern Approach</i>, Pearson.</small>
</section>
<section>
<h3>Path-Planning as Graph Search</h3>

<p>

<ul>
<li>So, imagine an agent that travels on the TestMap:

<div align=center>
<img src=images/topo_metro.jpg width=600>
</div>

<li>The goal is to get in [905, 249, 298, 938, 939, 940] <br> (from node 976).
</ul>

</section>
<section>
<h3>Path-Planning as Graph Search</h3>

<p>

<ul>
<li>You not only have to find one solution:

<div align=center>
<img src=images/test_two_paths.jpg width=600>
</div>

<li>You also have to decide what is the best solution.
</ul>

</section>
<section>
<h3>Path-Planning as Graph Search</h3>

<p>

<ul>
<li>And you have to find it fast when the map gets bigger:

<div align=center>
<img src=images/ParisPGraph.jpg width=600>
</div>
That is where the <i>search strategy</i> gets important<br>
(e.g. Dijkstra vs A*)
</ul>

</section>
<section>
<h3>A* Graph Search</h3>

<p>

<ul>
<li>The Agent Development Framework has an A* implementation:

<div align=center>
<img src=images/EclipseUniformCostSearch.png width=900>
</div>
The problem is solved in 9 steps.
</ul>

<p>

 <small>This Java code is provided by Shunki Takami <i>et al.</i></small>

</section>

<section>
<h3>A* Graph Search</h3>

<p>

<ul>
<li>The steps resembles Uniform-Cost Search:

<div align=center>
<img src=images/UniformCostSearch.png width=900>
</div>
With a heuristic cost function <font style="font-variant: small-caps">Path-Cost</font> this is A* <br>
(with path so-far it is Dijkstra's algorithm).
</ul>

<p>

 <small>Illustration courtesy Stuart Russell and Peter Norvig, <i>Artificial Intelligence - a Modern Approach</i>, Pearson.</small>

</section>
<section>
<h3>Multi-Agent decision making</h3>

<p>

<ul>
<li>The actions of the agents are parameterized with the paths.

<div align=center>
<img src=images/Mircea-Figure1.1.png width=500>
</div>
<li>You need full control and insight in the characteristics of the paths.
</ul>

<p>

 <small>Illustration courtesy Mircea Traichioiu, <i>Hierarchical Decision Theoretic Planning for RoboCup Rescue Agent Simulation</i>, Master thesis, University of Amsterdam, 2014.</small>

</section>


<section>
<h3>Export Java datastructure to Matlab</h3>

<p>
<br>
<p>

<div align=left style="border: 2px solid black">
<small>
<code> <!-- &#09; is TAB -->
For (Entity next: this.worldInfo.getEntities() ) {<br>
&nbsp;&#09; loc = this.worldInfo.getLocation(next.getID()); <br>
&nbsp;&#09; matlab.eval("G=addnode(G,table(next.getID(),loc.first(),loc.second());");<br>
}<br>
For (Entity next: this.worldInfo.getEntities() )<br>
&nbsp;&#09;  Collection areaNeighbours = next.getNeighbours();<br>
  <br>
&nbsp;&#09;  for(entityID neighbour : areaNeigbours) {<br>
&nbsp;&#09;&nbsp;&#09;    matlab.eval("G=addedge(G,find(next.getID()),find(neighbour.getID());");<br>
&nbsp;&#09;  }<br>
}<br>
matlab.eval("save('graph.mat',G);");
</code>
</small>
</div>
</section>
<section>
<h3>Real Java-code</h3>

<p>

<ul>
<li>A little more complex: 

<div align=center>
<img src=images/matlab_init.png width=800>
</div>
<li>This code adds batches. An alternative is to create two complete lists and feed it at once to a matlab-function.
</ul>

<p>

 <small></small>

</section>
<section>
<h3>Effect batch-size</h3>

<p>

<ul>
<li>Adding the nodes to a graph of the Kobe map: 

<div align=center>
<table>
<tr><td>no batch</td><td>15,7999 s</td></tr>
<tr><td>batch of 25</td><td>1,6564 s</td></tr>
<tr><td>batch of 250</td><td>0,6677 s</td></tr>
<tr><td>batch of 2500</td><td>0,42233 s</td></tr>
</table>
</div>
<li>For Paris the whole process takes 52,75 s.
</ul>

<p>

 <small></small>

</section>
<section>
<h3>Execute this Java-code as precompute process</h3>

<p>
<br>
<p>

<div align=left style="border: 2px solid black">
<small>
<code> 
cd ~ <br>
mkdir git<br>
cd git<br>
git clone https://github.com/roborescue/rcrs-server.git<br>
<br>
cd rcrs-server/boot<br>
./start-precompute.sh -m ../maps/gml/kobe/map/ -c ../maps/gml/kobe/config/
</code>
</small>
</div>

<p>
<br>
<p>

<div align=left style="border: 2px solid black">
<small>
<code> 
cd ~ <br>
mkdir git<br>
cd git<br>
git clone https://github.com/IntelligentRoboticsLab/Joint-Rescue-Forces.git<br>
cd Joint-Rescue-Forces<br>
./precompute-matlab.sh 1 0 1 0 1 0 localhost
</code>
</small>
</section>
<section>
<h3>Load the graph into Matlab workspace</h3>

<p>
<br>
<p>

<div align=left style="border: 2px solid black">
<small>
<code> 
load ../data/graph.mat<br>
plot(G,'NodeLabel',cellstr(G.Nodes.ID));<br>
</code>
</small>
</div>

<p>
<br>
<p>

<div align=left style="border: 2px solid black">
<small>
<code> 
figure(2)<br>
plot(G,'xdata',G.Nodes.X,'ydata',G.Nodes.Y,'NodeLabel',cellstr(G.Nodes.ID));<br>
</code>
</small>
</section>
<section>
<h3>Visualize Graph</h3>

<p>

<ul>
<li>The <i>x,y</i> positions of the nodes are known, but only the edges matter: 

<div align=center>
<img src=images/kobe_topo.jpg height=300>&nbsp;<img src=images/kobe_metric.jpg height=300>
</div>
<li>That is the connectivity and the distances of the edges.
</ul>

<p>

 <small></small>
</section>
<section>
<h3>Plan shortest path</h3>

<p>

<div align=left style="border: 2px solid black">
<small>
<code> 
from = find(G.Nodes.ID=="36373");<br>
target = [find(G.Nodes.ID=="33976") find(G.Nodes.ID=="35378") find(G.Nodes.ID=="34146")];<br>
[TR,D] = shortestpathtree(G,from,target,'OutputForm','cell');
</code>
</small>
</div>

</section>
<section>
<h3>Path found</h3>

<p>

<ul>
<li>There is a clear winner (both in number of steps and distance): 

<div align=center>
<img src=images/kobe_three_paths_from_36373.jpg width=400>
</div>
</ul>


<div align=left style="border: 2px solid black">
<small>
<code> 
D = <br>
&nbsp;&#09;       252553       68434      397069<br>
TR =<br>
&nbsp;&#09;     {1×37 double}<br>
&nbsp;&#09;     {1×9  double}<br>
&nbsp;&#09;     {1×66 double}<br>
</code>
</small>
</div>

<p>

 <small>Highlight_path is function of Peter Corke's Robotics toolbox</small>
</section>
<section>
<h3>Find paths faster</h3>

<p>

<ul>
<li>You can use different algorithms to plan a path: 

<div align=center>
<img src=images/kobe_depth_first.jpg width=400>
</div>
</ul>


<div align=left style="border: 2px solid black">
<small>
<code>  
PG.shortestpath(M(char("36373")),M(char("33976")),'algorithm', 'depth-first', 'timer') <br>
costs=256829, time=0.087983<br>
PG.shortestpath(M(char("36373")),M(char("33976")),'algorithm', 'Astar', 'timer') <br>
costs=252553, time=0.095392<br>
PG.shortestpath(M(char("36373")),M(char("33976")),'algorithm', 'Dijkstra', 'timer') <br>
costs=252553, time=0.202984<br>
</code>
</small>
</div>

<p>

 <small>shortestpath is modification of Peter Corke's open source Astar implementation.</small>
</section>
<section>
<h3>Modify travel cost after disaster</h3>

<p>

<ul>
<li>After the earthquake building have collapsed and roads are (partly blocked): 

<div align=center>
<img src=images/blockade.png width=300>
</div>

<li>In that case the travel costs can be increased:
</ul>


<div align=left style="border: 2px solid black">
<small>
<code>  
neighbours = PG.neighbours(909);<br>
edges = PG.edges(909);<br>
new_cost = 4 .* PG.cost(edges);<br>
[path_index,C] = PG.shortestpath(M(char("36373")),M(char("33976")),'algorithm', 'Astar');
</code>
</small>
</div>

<p>

 <small>Blockade illustration is courtesy Ali Modaresi.</small>
</section>
<section>
<h3>Astar will go around blockade</h3>

<p>

<ul>
<li>The edge was not removed, the travel-cost were only increased: 

<div align=center>
<img src=images/kobe_astar_with_blockade.jpg width=400>
</div>

<li>The new path is the red path.
<li>This can be done for each agent individually, based on observations and team-communication.
</ul>


<div align=center style="border: 2px solid black">
<large>
This is now your assignment!
</large>
</div>

<p>

</section>


      </section>
      <!-- ========================================================= -->
      <section>
        <section>
            <h2>Machine Learning for Precomputation</h2>
              <ul>
                <li>Clustering (K-Means++)
                  <ul>
                    <li>Type and collection of data</li>
                    <li>Visualize using MATLAB</li>
                    <li>Integrate into ADF</li>
                  </ul>
                </li>
              </ul>
        </section>
      </section>
      <section>
        <section>
            <h2>Methodology for Target Selection</h2>
              <ul>
                <li>Target selection model
                  <ul>
                    <li>Traditional Machine Learning (SVM)</li>
                    <li>Deep Learning</li>
                  </ul>
                </li>
                <li>Collect data</li>
                <li>Train model in MATLAB</li>
                <li>Integrate into ADF</li>
                <li>Refine the target selection model</li>
              </ul>
        </section>
      </section>

      <!-- ========================================================= -->
    </div>
  </div>

  <script
    src="reveal/lib/js/head.min.js"
  ></script>
  <script
    src="reveal/js/reveal.min.js"
  ></script>

  <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize( {
        controls: true,
        progress: true,
        history: false,
        center: true,
        
        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
        
        // Optional libraries used to extend on reveal.js
        dependencies: [{
          src: 'lib/js/classList.js',
          condition: function () {
            return !document.body.classList;
          }
        }, {
          src: 'plugin/markdown/showdown.js',
          condition: function () {
            return !!document.querySelector( '[data-markdown]' );
          }
        }, {
          src: 'plugin/markdown/markdown.js',
          condition: function () {
            return !!document.querySelector( '[data-markdown]' );
          }
        }, {
          src: 'plugin/highlight/highlight.js',
          async: true,
          callback: function () {
            hljs.initHighlightingOnLoad();
          }
        }, {
          src: 'plugin/zoom-js/zoom.js',
          async: true,
          condition: function () {
            return !!document.body.classList;
          }
        }, {
          src: 'plugin/notes/notes.js',
          async: true,
          condition: function () {
            return !!document.body.classList;
          }
        }]
      } );
    </script>

</body>
</html>
